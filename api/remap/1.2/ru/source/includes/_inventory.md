<!-- include(metadata.apib) -->

# Документ Инвентаризация
Средствами JSON API можно создавать и обновлять сведения о Инвентаризации, запрашивать списки Инвентаризаций и сведения по отдельным Инвентаризациям. Позициями Инвентаризации можно управлять как в составе отдельной Инвентаризации, так и отдельно - с помощью специальных ресурсов для управления позициями Инвентаризации. Кодом сущности для Инвентаризации в составе JSON API является ключевое слово **inventory**. Больше о Инвентаризациях можно прочитать [этой ссылке](https://support.moysklad.ru/hc/ru/articles/203309933-%D0%98%D0%BD%D0%B2%D0%B5%D0%BD%D1%82%D0%B0%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D1%82%D0%BE%D0%B2%D0%B0%D1%80%D0%BE%D0%B2).
## Инвентаризация [/entity/inventory]
### Атрибуты сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о Инвентаризации
+ **id** - ID в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **syncId** - ID синхронизации. После заполнения недоступен для изменения.
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **deleted** - Момент последнего удаления сущности `Только для чтения`
+ **name** - номер Инвентаризации
+ **externalCode** - Внешний код Инвентаризации
+ **moment** - Дата Инвентаризации
+ **sum** - Сумма Инвентаризации в копейках `Только для чтения`
+ **owner** - Ссылка на Владельца (Сотрудника) в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **shared** - Общий доступ
+ **group** - Отдел сотрудника в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **organization** - Ссылка на ваше юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **store** - Ссылка на склад в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **state** - Статус Инвентаризации в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **attributes** - Коллекция доп. полей в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
<br>Поля при expand'е:</br>
  - **name** - номер документа
  - **moment** - дата печати
  - **href** - ссылка на файл печатной формы
  - **fileName** - название файла печатной формы
  - **updated** - дата последнего изменения
+ **created** - Дата создания `Только для чтения`
+ **positions** - Ссылка на позиции Инвентаризации в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

### Позиции Инвентаризации
Позиции Инвентаризации - это список товаров/модификаций/серий.
Объект позиции Инвентаризации содержит следующие поля:
+ **id** - ID товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **quantity** - Фактическое количество товаров/модификаций/серий.
+ **price** - Цена товара в копейках
+ **assortment** - Ссылка на товар/серию/модификацию, которую представляет собой позиция, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **pack** - Упаковка товара
+ **correctionAmount** - разница между расчетным остатком и фактическим `Только для чтения`
+ **calculatedQuantity** - расчетный остаток
+ **correctionSum** - избыток/недостача `Только для чтения`

С позициями можно работать с помощью [специальных ресурсов для управления позициями Инвентаризации](#документ-инвентаризация-позиции-инвентаризации),
а также в составе отдельной Инвентаризации. При работе в составе отдельной Инвентаризации,
вы можете отправлять запросы на создание отдельной Инвентаризации с включенным в тело запроса
массивом позиций Инвентаризации. Если количество позиций превышает максимально допустимое, то для
дальнейшего пополнения позиций нужно будет работать со специальным ресурсом "Позиции Инвентаризации".
Также, при работе в составе отдельной Инвентаризации, можно отправлять запросы на обновление списка позиций
с включенным в тело запроса массивом позиций Инвентаризации. При этом важно помнить, что коллекция позиций будет
восприниматься как "все позиции Инвентаризации" и полностью заменит уже существующую коллекцию при обновлении объекта - лишние
позиции будут удалены, новые добавлены, существующие - изменены.

О работе с доп. полями Инвентаризации можно прочитать [здесь](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями)


### Получить Инвентаризации [GET]
Запрос всех Инвентаризаций на данной учётной записи.
Результат: Объект JSON, включающий в себя поля:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой Инвентаризации.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

  + search: `0001` (optional, string)
    URL Параметр для поиска по имени документа.
    Фильтр документов по указанной поисковой строке. Фильтрация происходит по
    полю name.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Инвентаризаций.
  + Body
        <!-- include(body/inventory/get_list.json) -->

### Создать Инвентаризацию [POST]
Запрос на создание новой Инвентаризации
+ Request Пример (application/json)
Пример создания новой Инвентаризации с телом запроса, содержащим только необходимые поля.
  + Body
        <!-- include(body/inventory/post_request_short.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной Инвентаризации.
  + Body
        <!-- include(body/inventory/post_response_short.json) -->

### Массовое создание и обновление Инвентаризаций [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) Инвентаризаций.
В теле запроса нужно передать массив, содержащий JSON представления Инвентаризаций, которые вы хотите создать или обновить.
Обновляемые Инвентаризации должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких Инвентаризаций
  + Body
        <!-- include(body/inventory/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных Инвентаризаций.
  + Body
        <!-- include(body/inventory/post_massive_response.json) -->

### Удалить Инвентаризацию [DELETE /entity/inventory/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Инвентаризации

Запрос на удаление Инвентаризации с указанным id.
+ Response 200 (application/json)
Успешное удаление Инвентаризации.

## Метаданные Инвентаризаций [/entity/inventory/metadata]
### Метаданные Инвентаризаций [GET]
Запрос на получение метаданных Инвентаризаций. Результат - объект JSON, включающий в себя:
+ **meta** - Ссылка на метаданные Инвентаризаций
+ **attributes** - Массив объектов доп. полей Инвентаризаций в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **states** - Массив статусов Инвентаризаций
+ **createShared** - создавать новые Инвентаризации с меткой "Общий"

Структура отдельного объекта, представляющего доп. поле подробно описана в разделе [Работа с дополнительными полями](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями).

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление метаданных Инвентаризаций.
  + Body
        <!-- include(body/inventory/get_metadata.json) -->

## Отдельное доп. поле [/entity/inventory/metadata/attributes/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Доп. поля
### Отдельное доп. поле [GET]
Запрос на получение информации по отдельному дополнительному полю.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного доп. поля.
  + Body
        <!-- include(body/inventory/metadata_by_id.json) -->

## Шаблон инвентаризации [/entity/inventory/new]
### Шаблон инвентаризации [PUT]
Запрос на получение предзаполненого стандартными значениями шаблона инвентаризации без связи с каким-либо документом.

+ Request Пустое тело запроса (application/json)
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного списания.
  + Body
        <!-- include(body/inventory/new_empty.json) -->

## Инвентаризация [/entity/inventory/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Инвентаризации
### Получить Инвентаризацию [GET]
Запрос на получение отдельной инвентаризации с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Инвентаризации.
  + Body
        <!-- include(body/inventory/get_by_id.json) -->

### Изменить Инвентаризацию [PUT]
Запрос на обновление инвентаризации с указанным id.
+ Request Пример (application/json)
Пример запроса на обновление отдельной Инвентаризации.
  + Body
        <!-- include(body/inventory/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённой Инвентаризации.
  + Body
        <!-- include(body/inventory/put_response.json) -->

+ Request Пример с доп. полями (application/json)
Пример запроса на изменение Инвентаризации с дополнительными полями.
  + Body
        <!-- include(body/inventory/put_with_attributes_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённой Инвентаризации.
  + Body
        <!-- include(body/inventory/put_with_attributes_response.json) -->

## Позиции Инвентаризации [/entity/inventory/{id}/positions]
Отдельный ресурс для управления позициями Инвентаризации. С его помощью вы можете управлять позициями большого документа, количество строк в котором превышает лимит на количество строк, сохраняемых вместе с документом. Этот лимит равен 100. Более подробно о лимитах на количество строк документа и работе с большими документами можно прочитать [тут](/api/remap/1.2/doc/index.html#header-работа-с-позициями-документов).
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Инвентаризации
### Получить позиции Инвентаризации [GET]
Запрос на получение списка всех позиций данной Инвентаризации.
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой позиции Инвентаризации.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка позиций отдельной Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_get_list.json) -->

### Создать позицию Инвентаризации [POST]
Запрос на создание новой позиции в Инвентаризации.
Для успешного создания необходимо в теле запроса указать следующие поля:
+ **assortment** - Ссылка на товар/серию/модификацию, которую представляет собой позиция.
Также можно указать поле с именем  **consignment**, **variant** в соответствии с тем,
чем является указанная позиция. Подробнее об этом поле можно прочитать в описании [позиции Инвентаризации](#header-позиции-инвентаризации)
+ **quantity** - Количество указанной позиции. Должно быть положительным, иначе возникнет ошибка.
Одновременно можно создать как одну так и несколько позиций Инвентаризации. Все созданные данным запросом позиции
будут добавлены к уже существующим.

+ Request Пример (application/json)
Пример создания позиций в Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_post_one_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной позиции отдельной Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_post_one_response.json) -->

## Позиция Инвентаризации [/entity/inventory/{id}/positions/{positionID}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Инвентаризации
  + positionID: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id позиции

### Получить позицию [GET]
Запрос на получение отдельной позиции Инвентаризации с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельной позиции Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_get_by_id.json) -->

### Изменить позицию [PUT]
Запрос на обновление отдельной позиции Инвентаризации. Для обновления позиции нет каких-либо
 обязательных для указания в теле запроса полей. Только те, что вы желаете обновить.
+ Request Пример (application/json)
Пример запроса на обновление отдельной позиции в Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённой позиции Инвентаризации.
  + Body
        <!-- include(body/inventory/positions_put_response.json) -->

### Удалить позицию [DELETE]
Запрос на удаление отдельной позиции Инвентаризации с указанным id.

+ Response 200 (application/json)
Успешное удаление позиции Инвентаризации.
