<!-- include(metadata.apib) -->

# Документ Исходящий платеж
## Исходящие платежи   [/entity/paymentout]
Средствами JSON API можно создавать и обновлять сведения о Исходящем платеже, запрашивать списки Исходящих платежей  и сведения по отдельным Исходящим платежам. Кодом сущности для Исходящего платежа  в составе JSON API является ключевое слово **paymentout**. Больше о платежа х и работе с ними в основном интерфейсе вы можете прочитать в нашей службе поддержки по [этой ссылке](https://support.moysklad.ru/hc/ru/articles/203025346-%D0%9F%D0%BB%D0%B0%D1%82%D0%B5%D0%B6%D0%B8).

### Атрибуты сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о Исходящем платеже
+ **id** - ID в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **syncId** - ID синхронизации. После заполнения недоступен для изменения.
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **deleted** - Момент последнего удаления сущности `Только для чтения`
+ **name** - номер Исходящего платежа
+ **description** - Комментарий Исходящего платежа
+ **externalCode** - Внешний код Исходящего платежа
+ **moment** - Дата Исходящего платежа
+ **applicable** - Отметка о проведении
+ **sum** - Сумма Исходящего платежа  в установленной валюте
+ **project** - Ссылка на проект в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **rate** - Валюта
+ **owner** - Ссылка на Владельца (Сотрудника) в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **shared** - Общий доступ
+ **group** - Отдел сотрудника в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **organization** - Ссылка на ваше юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **agent** - Ссылка на контрагента или юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **contract** - Ссылка на договор в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **state** - Статус Исходящего платежа  в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **organizationAccount** - Ссылка на счёт вашего юрлица в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **agentAccount** - Ссылка на счёт контрагента в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **attributes** - Коллекция доп. полей в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
<br>Поля при expand'е:</br>
  - **name** - номер документа
  - **moment** - дата печати
  - **href** - ссылка на файл печатной формы
  - **fileName** - название файла печатной формы
  - **updated** - дата последнего изменения
+ **created** - Дата создания `Только для чтения`
+ **paymentPurpose** - Назначение платежа
+ **vatSum** - Сумма включая НДС
+ **expenseItem** - Статья расходов в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
### Связи с другими документами
+ **factureIn** - Ссылка на Счет-фактура полученный, с которым связан этот платеж, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **operations** - Массив ссылок на связанные операции
  - **meta** - Ссылка на операцию, к которой привязан этот платёж в формате метаданных
  - **linkedSum** - Сумма, оплаченная по данному документу из этого платежа

Разрешенные типы связанных операций:
+ Возврат покупателя (salesreturn)
+ Приёмка (supply)
+ Счёт поставщика (invoicein)
+ Заказ поставщику (purchaseorder)
+ Выданный отчёт комиссионера (commissionreportout)

<!-- include(rate.apib) -->

О работе с доп. полями Исходящих  платежей  можно прочитать [здесь](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями)


### Получить Исходящие платежи   [GET]
Запрос всех Исходящих  платежей  на данной учётной записи.
Результат: Объект JSON, включающий в себя поля:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой Исходящие платежи  .
+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

  + search: `0001` (optional, string)
    URL Параметр для поиска по имени документа.
    Фильтр документов по указанной поисковой строке. Фильтрация происходит по
    полю name.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Исходящих платежей .
  + Body
        <!-- include(body/payment_out/get_list.json) -->

### Создать Исходящий платеж  [POST]
Запрос на создание нового Исходящего платежа .
Обязательные для создания поля:
+ **name** - номер Исходящего платежа
+ **organization** - Ссылка на ваше юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **agent** - Ссылка на контрагента  в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **expenseItem** - Статья расходов в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ Request Пример (application/json)
Пример создания нового Исходящего платежа  с телом запроса, содержащим только необходимые поля.
  + Body
        <!-- include(body/payment_out/post_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного Исходящего платежа .
  + Body
        <!-- include(body/payment_out/post_response.json) -->

### Массовое создание и обновление Исходящих платежей [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) Исходящих платежей.
В теле запроса нужно передать массив, содержащий JSON представления Исходящих платежей, которые вы хотите создать или обновить.
Обновляемые Исходящие платежи должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких Исходящих платежей
  + Body
        <!-- include(body/payment_out/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных Исходящих платежей.
  + Body
        <!-- include(body/payment_out/post_massive_response.json) -->


### Удалить Исходящий платеж  [DELETE /entity/paymentout/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Исходящего платежа

Запрос на удаление Исходящего платежа  с указанным id.

+ Response 200 (application/json)
Успешное удаление Исходящего платежа .

## Метаданные Исходящих платежей [/entity/paymentout/metadata]
### Метаданные Исходящих платежей  [GET]
Запрос на получение метаданных Исходящих платежей . Результат - объект JSON, включающий в себя:
+ **meta** - Ссылка на метаданные Исходящих платежей
+ **attributes** - Массив объектов доп. полей Исходящих платежей в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **states** - Массив статусов Исходящих платежей
+ **createShared** - создавать новые Исходящие платежи с меткой "Общий"

Структура отдельного объекта, представляющего доп. поле подробно описана в разделе [Работа с дополнительными полями](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями).

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление доп. полей Исходящих платежей .
  + Body
        <!-- include(body/payment_out/metadata.json) -->

## Отдельное доп. поле [/entity/paymentout/metadata/attributes/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Доп. поля
### Отдельное доп. поле [GET]
Запрос на получение информации по отдельному дополнительному полю.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного доп. поля.
  + Body
        <!-- include(body/payment_out/metadata_by_id.json) -->

## Шаблон исходящего платежа [/entity/paymentout/new]
### Шаблон исходящего платежа [PUT]
Запрос на получение предзаполненого стандартными значениями шаблона исходящего платежа без связи с каким-либо документом.
+ Request Пустой запрос (application/json)
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_empty.json) -->

### Шаблон исходящего платежа на основе [PUT]
Запрос на создание получение прелзаполненного исходящего платежа на основе другого документа.
В результате запроса, будет создан предзаполненный шаблон исходящего платёж на основе переданного документа.

+ Request заказ поставщику (application/json)
Запрос на получение шаблона исходящего платежа на основе заказа поставщику.
  + Body
        <!-- include(body/payment_out/new_purchaseorder_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_purchaseorder_response.json) -->

+ Request возврат покупателя (application/json)
Запрос на получение шаблона исходящего платежа на основе возврата покупателя.
  + Body
        <!-- include(body/payment_out/new_sales_return_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_sales_return_response.json) -->

+ Request приёмка (application/json)
Запрос на получение шаблона исходящего платежа на основе приёмки.
  + Body
        <!-- include(body/payment_out/new_supply_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_supply_response.json) -->

+ Request счёт поставщика (application/json)
Запрос на получение шаблона исходящего платежа на основе счёта поставщика.
  + Body
        <!-- include(body/payment_out/new_invoice_in_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_invoice_in_response.json) -->
+ Request выд отчёт комиссионера (application/json)
Запрос на получение шаблона исходящего платежа на основе выданного отчёта комиссионера.
  + Body
        <!-- include(body/payment_out/new_commissionreportout_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненного исходящего платежа.
  + Body
        <!-- include(body/payment_out/new_commissionreportout_response.json) -->

## Исходящий платеж  [/entity/paymentout/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Исходящего платежа
### Получить Исходящий платеж  [GET]
Запрос на получение отдельного Исходящего платежа с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Исходящего платежа.
  + Body
        <!-- include(body/payment_out/get_by_id.json) -->

### Изменить Исходящий платеж  [PUT]
Запрос на обновление Исходящего платежа   с указанным id.
В теле запроса можно указать только те поля, которые необходимо изменить у Исходящего платежа , кроме тех, что
помечены `Только для чтения` в описании [атрибутов Исходящего платежа ](#документ-исходящий-платеж-исходящие-платежи).
При обновлении полей **organization** и **agent** нужно также обновить поля **organizationAccount** и
**agentAccount** соответственно, иначе произойдёт ошибка.

Для привязки исходящего платежа к другим документам
нужно положить в поле под именем **operations** все **meta** тех документов, к которым вы хотите привязать финансовую операцию.
Также для каждого документа можно указать cумму, оплаченную по данному документу из этого платежа **linkedSum**.

+ Request Пример (application/json)
Пример запроса на обновление отдельного Исходящего платежа .
  + Body
        <!-- include(body/payment_out/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого Исходящего платежа .
  + Body
        <!-- include(body/payment_out/put_response.json) -->
