<!-- include(metadata.apib) -->

# Документ Тех. операция
Средствами JSON API можно создавать и обновлять сведения о Тех. операциях, запрашивать списки Тех. операций и сведения по отдельным Тех. операциям. Позициями Тех. операций можно управлять как в составе отдельной Тех. операции, так и отдельно - с помощью специальных ресурсов для управления материалами и продуктами Тех. операции. Кодом сущности для Тех. операции в составе JSON API является ключевое слово **processing**. Больше о Тех. операциях и работе с ними в основном интерфейсе вы можете прочитать в нашей службе поддержки по
[этой ссылке](https://support.moysklad.ru/hc/ru/articles/203325613-%D0%A1%D0%B1%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D1%8B%D0%B5-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8).
## Тех. операции [/entity/processing]
### Атрибуты сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о Заказе на производство
+ **id** - ID в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **syncId** - ID синхронизации. После заполнения недоступен для изменения.
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **deleted** - Момент последнего удаления сущности `Только для чтения`
+ **name** - номер Тех. операции на производство
+ **description** - Комментарий Тех. операции на производство
+ **externalCode** - Внешний код Тех. операции на производство
+ **moment** - Дата Тех. операции
+ **applicable** - Отметка о проведении
+ **owner** - Ссылка на Владельца (Сотрудника) в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **shared** - Общий доступ
+ **group** - Отдел сотрудника в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **organization** - Ссылка на ваше юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **organizationAccount** - Ссылка на счёт вашего юрлица в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **state** - Статус Тех. операции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **attributes** - Коллекция доп. полей в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
<br>Поля при expand'е:</br>
  - **name** - номер документа
  - **moment** - дата печати
  - **href** - ссылка на файл печатной формы
  - **fileName** - название файла печатной формы
  - **updated** - дата последнего изменения
+ **created** - Дата создания `Только для чтения`
+ **quantity** - Объем производства `Необходимое`
+ **processingSum** - Затраты на производство `Необходимое`
+ **materials** - Список материалов Тех. операции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **products** - Список готовых продуктов Тех. операции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **productsStore** - Ссылка на склад для продукции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **materialsStore** - Ссылка на склад для материалов в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **processingPlan** - Ссылка на Тех. операцию в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **project** - Ссылка на проект в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
### Связи с другими документами
+ **processingOrder** - Ссылка на заказ на производство в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

### Материалы Тех. операции
Материалы Тех. операции - это список товаров/модификаций/серий, используемых для производства готовых продуктов согласно тех. карте.
Объект материала Тех. операции содержит следующие поля:
+ **id** - ID товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **assortment** - Ссылка на товар/модификацию/серию, которую представляет собой позиция, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **quantity** - Количество товаров данного вида в позиции.

### Продукты Тех. операции
Продукты Тех. операции - это список товаров/модификаций/серий, получаемых при производстве согласно тех. карте.
Объект продукта Тех. операции содержит следующие поля:
+ **id** - ID товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **assortment** - Ссылка на товар/модификацию/серию, которую представляет собой позиция, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **quantity** - Количество товаров данного вида в позиции.


С материалами и продуктами можно работать с помощью [специальных ресурсов для управления позициями Тех. операции](#документ-тех.-операция-материалы-тех.-операции),
а также в составе отдельной Тех. операции. При работе в составе отдельной Тех. операции,
вы можете отправлять запросы на создание отдельной Тех. операции с включенными в тело запроса
массивами материалов и продуктов Тех. операции.
Также, при работе в составе отдельной Тех. операции, можно отправлять запросы на обновление списка материалов и продуктов
с включенными в тело запроса массивами материалов и продуктов Тех. операции. Состав материалов и продуктов Тех. операции не может быть изменён.
Состав материалов и продуктов должен соответствовать тех. карте.


### Получить список Тех. операций [GET]
Запрос всех Тех. операций на данной учётной записи.
Результат: Объект JSON, включающий в себя поля:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой Тех. операции.
+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

  + search: `0001` (optional, string)
    URL Параметр для поиска по имени документа.
    Фильтр документов по указанной поисковой строке. Фильтрация происходит по
    полю name.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Тех. операций.
  + Body
        <!-- include(body/processing/get_list.json) -->

### Создать Тех. операцию[POST]
Запрос на создание новой Тех. операции.
Обязательные для создания поля:
+ **organization** - Ссылка на ваше юрлицо в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **processingSum** - Затраты на производство
+ **quantity** - Объем производства
+ **processingPlan** - Ссылка на Тех. операцию в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **productsStore** - Ссылка на склад для продукции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **materialsStore** - Ссылка на склад для материалов в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **materials** - Список материалов Тех. операции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **products** - Список готовых продуктов Тех. операции в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

+ Request Пример 1 (application/json)
Пример создания новой Тех.операции с телом запроса, содержащим только необходимые поля.
  + Body
        <!-- include(body/processing/post_short_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной Тех. операции.
  + Body
        <!-- include(body/processing/post_short_response.json) -->

+ Request Пример 2 (application/json)
Пример создания новой Тех.операции.
    + Body
        <!-- include(body/processing/post_long_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной Тех. операции.
    + Body
        <!-- include(body/processing/post_long_response.json) -->

### Массовое создание и обновление Тех.операций [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) Тех.операций.
В теле запроса нужно передать массив, содержащий JSON представления Тех.операций, которые вы хотите создать или обновить.
Обновляемые Тех.операции должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких Тех.операций
  + Body
        <!-- include(body/processing/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных Тех.операций.
  + Body
        <!-- include(body/processing/post_massive_response.json) -->

### Удалить Тех. операцию [DELETE /entity/processing/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. операции

Запрос на удаление Тех. операции с указанным id.

+ Response 200 (application/json)
Успешное удаление Тех. операции.


## Метаданные Тех. операций [/entity/processing/metadata]
### Метаданные Тех. операций [GET]
Запрос на получение метаданных Тех. операций. Результат - объект JSON, включающий в себя:
+ **meta** - Ссылка на метаданные Тех. операций
+ **attributes** - Массив объектов доп. полей Тех. операций в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **states** - Массив статусов Тех. операций
+ **createShared** - создавать новые Тех. операции с меткой "Общий"

Структура отдельного объекта, представляющего доп. поле подробно описана в разделе [Работа с дополнительными полями](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями).

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление доп. полей Тех. операций.
  + Body
        <!-- include(body/processing/get_metadata.json) -->

## Отдельное доп. поле [/entity/processing/metadata/attributes/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Доп. поля
### Отдельное доп. поле [GET]
Запрос на получение информации по отдельному дополнительному полю.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного доп. поля.
  + Body
        <!-- include(body/processing/metadata_by_id.json) -->

## Шаблон Тех. операции [/entity/processing/new]

### Шаблон Тех. операции на основе [PUT]
Запрос на получение предзаполненной тех. операции на основе другого документа.
В результате запроса будет создан предзаполненный шаблон тех. операции на основе переданного документа.

+ Request заказ на производство (application/json)
Запрос на получение шаблона тех. операции на основе заказа на производство.
  + Body
        <!-- include(body/processing/new_processingorder_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненной тех. операции.
  + Body
        <!-- include(body/processing/new_processingorder_response.json) -->

+ Request тех. карта (application/json)
Запрос на получение шаблона тех. операции на основе тех. карты.
  + Body
        <!-- include(body/processing/new_processingplan_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление предзаполненной тех. операции.
  + Body
        <!-- include(body/processing/new_processingplan_response.json) -->

## Тех. операция [/entity/processing/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. операции

### Получить Тех. операцию [GET]
Запрос на получение отдельной Тех. операции с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Тех. операции.
  + Body
        <!-- include(body/processing/get_by_id.json) -->


### Изменить Тех. операцию [PUT]
Запрос на обновление Тех. операции с указанным id.
В теле запроса можно указать только те поля, которые необходимо изменить у Тех. операции, кроме тех, что
помечены `Только для чтения` в описании [атрибутов Тех. операции](#документ-тех.-операция-тех.-операции).

+ Request Пример (application/json)
Пример запроса на обновление отдельной Тех. операции.
  + Body
        <!-- include(body/processing/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновленной Тех. операции.
  + Body
        <!-- include(body/processing/put_response.json) -->

## Материалы Тех. операции [/entity/processing/{id}/materials]
Отдельный ресурс для управления материалами Тех. операции. С его помощью вы можете управлять материалами большого документа, количество материалов в котором превышает лимит на количество материалов, сохраняемых вместе с документом. Этот лимит равен 100. Более подробно о лимитах на количество строк документа и работе с большими документами можно прочитать [тут](/api/remap/1.2/doc/index.html#header-работа-с-позициями-документов).
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. операции
### Получить материалы Тех. операции [GET]
Запрос на получение списка всех материалов данной Тех. операции.
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой материалы Тех. операции.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка материалов отдельной Тех. операции.
  + Body
        <!-- include(body/processing/materials_get_list.json) -->

## Материал Тех. операции [/entity/processing/{id}/materials/{positionID}]
+ Parameters
  + id: `d72b4281-b000-11e6-8af5-581e00000074` (required, string) - id Тех. операции
  + positionID: `9560e3e3-9609-11e6-8af5-581e00000008` (required, string) - id позиции Тех. операции

### Получить материал [GET]
Запрос на получение отдельного материала Тех. операции с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного материала Тех. операции.
  + Body
        <!-- include(body/processing/materials_get_by_id.json) -->

### Изменить материал [PUT]
Запрос на обновление отдельного материала Тех. операции. Для обновления материала нет каких-либо
 обязательных для указания в теле запроса полей. Только те, что вы желаете обновить.
+ Request Пример (application/json)
Пример запроса на обновление отдельного материала в Тех. операции.
  + Body
        <!-- include(body/processing/materials_put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого материала Тех. операции.
  + Body
        <!-- include(body/processing/materials_put_response.json) -->

## Продукты Тех. операции [/entity/processing/{id}/products]
Отдельный ресурс для управления продуктами Тех. операции. С его помощью вы можете управлять продуктами большого документа, количество продуктов в котором превышает лимит на количество продуктов, сохраняемых вместе с документом. Этот лимит равен 100. Более подробно о лимитах на количество строк документа и работе с большими документами можно прочитать [тут](/api/remap/1.2/doc/index.html#header-работа-с-позициями-документов).
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. операции
### Получить продукты Тех. операции [GET]
Запрос на получение списка всех продуктов данной Тех. операции.
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой продукты Тех. операции.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка продуктов отдельной Тех. операции.
  + Body
        <!-- include(body/processing/products_get_list.json) -->

## Продукт Тех. операции [/entity/processing/{id}/products/{positionID}]
+ Parameters
  + id: `d72b4281-b000-11e6-8af5-581e00000074` (required, string) - id Тех. операции
  + positionID: `9560e3e3-9609-11e6-8af5-581e00000008` (required, string) - id продукта Тех. операции

### Получить продукт [GET]
Запрос на получение отдельного продукта Тех. операции с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного продукта Тех. операции.
  + Body
        <!-- include(body/processing/products_get_by_id.json) -->

### Изменить продукт [PUT]
Запрос на обновление отдельного продукта Тех. операции. Для обновления продукта нет каких-либо
 обязательных для указания в теле запроса полей. Только те, что вы желаете обновить.
+ Request Пример (application/json)
Пример запроса на обновление отдельного продукта в Тех. операции.
  + Body
        <!-- include(body/processing/products_put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого продукта Тех. операции.
  + Body
        <!-- include(body/processing/products_put_response.json) -->
