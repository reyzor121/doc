<!-- include(metadata.apib) -->

# Документ Тех. карта
Средствами JSON API можно создавать и обновлять сведения о Тех. картах, запрашивать списки Тех. карт и сведения по отдельным Тех. картам. Позициями Тех. карт можно управлять как в составе отдельной Тех. карты, так и отдельно - с помощью специальных ресурсов для управления материалами и продуктами Тех. карты. Кодом сущности для Тех. карты в составе JSON API является ключевое слово **processingplan**. Больше о Тех. картах и работе с ними в основном интерфейсе вы можете прочитать в нашей службе поддержки по
[этой ссылке](https://support.moysklad.ru/hc/ru/articles/203325613-%D0%A1%D0%B1%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D1%8B%D0%B5-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8).
## Тех. карты [/entity/processingplan]
### Атрибуты сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о Тех. карте
+ **id** - ID в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **owner** - Ссылка на Владельца (Сотрудника) в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **shared** - Общий доступ
+ **group** - Отдел сотрудника в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **deleted** - Момент последнего удаления сущности `Только для чтения`
+ **name** - Наименование Тех. карты `Необходимое`
+ **externalCode** - Внешний код Тех. карты
+ **pathName** - Наименование группы, в которую входит Тех. карта `Только для чтения`
+ **parent** - Ссылка на группу Тех. карты в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **cost** - Стоимость производства
+ **materials** - Список материалов Тех. карты в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **products** - Список готовых продуктов Тех. карты в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`

### Материалы Тех. карты
Материалы Тех. карты - это список товаров, используемых для производства готовых продуктов.
Объект материала Тех. карты содержит следующие поля:
+ **id** - ID товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **product** - Ссылка на товар, которую представляет собой позиция, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **quantity** - Количество товаров данного вида в позиции.

### Продукты Тех. карты
Продукты Тех. карты - это список товаров, получаемых при производстве.
Объект продукта Тех. карты содержит следующие поля:
+ **id** - ID товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **product** - Ссылка на товар, которую представляет собой позиция, в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **quantity** - Количество товаров данного вида в позиции.


С материалами и продуктами можно работать с помощью [специальных ресурсов для управления позициями Тех. карты](#документ-тех.-карта-материалы-тех.-карты),
а также в составе отдельной Тех. карты. При работе в составе отдельной Тех. карты,
вы можете отправлять запросы на создание отдельной Тех. карты с включенными в тело запроса
массивами материалов и продуктов Тех. карты. Если количество материалов или продуктов превышает максимально допустимое, то для
дальнейшего пополнения материалов и продуктов нужно будет работать со специальнымы ресурсами "Материалы Тех. карты" и "Продукты Тех. карты".
Также, при работе в составе отдельной Тех. карты, можно отправлять запросы на обновление списка материалов и продуктов
с включенными в тело запроса массивами материалов и продуктов Тех. карты. При этом важно помнить, что коллекции материалов и продуктов
полностью заменят уже существующие коллекции при обновлении объекта - лишние
позиции будут удалены, новые добавлены, существующие - изменены.


### Получить список Тех. карт [GET]
Запрос всех Тех. карт на данной учётной записи.
Результат: Объект JSON, включающий в себя поля:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой Тех. карты.
+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

  + search: `0001` (optional, string)
    URL Параметр для поиска по имени документа.
    Фильтр документов по указанной поисковой строке. Фильтрация происходит по
    полю name.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Тех. карт.
  + Body
        <!-- include(body/processingplan/get_list.json) -->

### Создать Тех. карту[POST]
Запрос на создание новой Тех. карты.
Обязательные для создания поля:
+ **name** - Наименование Тех. карты
+ **materials** - Список материалов Тех. карты в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **products** - Список готовых продуктов Тех. карты в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

+ Request Пример 1 (application/json)
Пример создания новой Тех.карты с телом запроса, содержащим только необходимые поля.
  + Body
        <!-- include(body/processingplan/post_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной Тех. карты.
  + Body
        <!-- include(body/processingplan/post_response.json) -->

### Массовое создание и обновление Тех. карт [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) Тех. карт.
В теле запроса нужно передать массив, содержащий JSON представления Тех. карт, которые вы хотите создать или обновить.
Обновляемые Тех. карты должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких Тех. карт
  + Body
        <!-- include(body/processingplan/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных Тех. карт.
  + Body
        <!-- include(body/processingplan/post_massive_response.json) -->

### Удалить Тех. карту [DELETE /entity/processingplan/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. карты

Запрос на удаление Тех. карты с указанным id.

+ Response 200 (application/json)
Успешное удаление Тех. карты.


## Тех. карта [/entity/processingplan/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. карты

### Получить Тех. карту [GET]
Запрос на получение отдельной Тех. карты с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Тех. карты.
  + Body
        <!-- include(body/processingplan/get_by_id.json) -->


### Изменить Тех. карту [PUT]
Запрос на обновление Тех. карты с указанным id.
В теле запроса можно указать только те поля, которые необходимо изменить у Тех. карты, кроме тех, что
помечены `Только для чтения` в описании [атрибутов Тех. карты](#документ-тех.-карта-тех.-карты).

+ Request Пример (application/json)
Пример запроса на обновление отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновленной Тех. карты.
  + Body
        <!-- include(body/processingplan/put_response.json) -->

## Материалы Тех. карты [/entity/processingplan/{id}/materials]
Отдельный ресурс для управления материалами Тех. карты. С его помощью вы можете управлять материалами большого документа, количество материалов в котором превышает лимит на количество материалов, сохраняемых вместе с документом. Этот лимит равен 100. Более подробно о лимитах на количество строк документа и работе с большими документами можно прочитать [тут](/api/remap/1.2/doc/index.html#header-работа-с-позициями-документов).
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. карты
### Получить материалы Тех. карты [GET]
Запрос на получение списка всех материалов данной Тех. карты.
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой материалы Тех. карты.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка материалов отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/materials_get_list.json) -->

### Создать материал Тех. карты [POST]
Запрос на создание нового материала в Тех. карте.
Для успешного создания необходимо в теле запроса указать следующие поля:
+ **product** - Ссылка на товар, которую представляет собой позиция.
+ **quantity** - Количество товаров в позиции.
+ Request Пример с одним материалом (application/json)
Пример создания одного материала в Тех. карте.
  + Body
        <!-- include(body/processingplan/materials_post_one_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного материала отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/materials_post_one_response.json) -->

+ Request Пример с несколькими позициями (application/json)
Пример создания сразу нескольких материалов в Тех. карте.
  + Body
        <!-- include(body/processingplan/materials_post_some_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка созданных материалов отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/materials_post_some_response.json) -->

## Материал Тех. карты [/entity/processingplan/{id}/materials/{positionID}]
+ Parameters
  + id: `d72b4281-b000-11e6-8af5-581e00000074` (required, string) - id Тех. карты
  + positionID: `9560e3e3-9609-11e6-8af5-581e00000008` (required, string) - id позиции Тех. карты

### Получить материал [GET]
Запрос на получение отдельного материала Тех. карты с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного материала Тех. карты.
  + Body
        <!-- include(body/processingplan/materials_get_by_id.json) -->

### Изменить материал [PUT]
Запрос на обновление отдельного материала Тех. карты. Для обновления материала нет каких-либо
 обязательных для указания в теле запроса полей. Только те, что вы желаете обновить.
+ Request Пример (application/json)
Пример запроса на обновление отдельного материала в Тех. карте.
  + Body
        <!-- include(body/processingplan/materials_put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого материала Тех. карты.
  + Body
        <!-- include(body/processingplan/materials_put_response.json) -->

### Удалить материал [DELETE]
Запрос на удаление материала Тех. карты с указанным id.

+ Response 200 (application/json)
Успешное удаление материала Тех. карты.

## Продукты Тех. карты [/entity/processingplan/{id}/products]
Отдельный ресурс для управления продуктами Тех. карты. С его помощью вы можете управлять продуктами большого документа, количество продуктов в котором превышает лимит на количество продуктов, сохраняемых вместе с документом. Этот лимит равен 100. Более подробно о лимитах на количество строк документа и работе с большими документами можно прочитать [тут](/api/remap/1.2/doc/index.html#header-работа-с-позициями-документов).
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Тех. карты
### Получить продукты Тех. карты [GET]
Запрос на получение списка всех продуктов данной Тех. карты.
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой продукты Тех. карты.

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка продуктов отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/products_get_list.json) -->

### Создать продукт Тех. карты [POST]
Запрос на создание нового продукта в Тех. карте.
Для успешного создания необходимо в теле запроса указать следующие поля:
+ **product** - Ссылка на товар, которую представляет собой позиция.
+ **quantity** - Количество товаров в позиции.
+ Request Пример с одним продуктом (application/json)
Пример создания одного продукта в Тех. карте.
  + Body
        <!-- include(body/processingplan/products_post_one_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного продукта отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/products_post_one_response.json) -->

+ Request Пример с несколькими позициями (application/json)
Пример создания сразу нескольких продуктов в Тех. карте.
  + Body
        <!-- include(body/processingplan/products_post_some_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка созданных продуктов отдельной Тех. карты.
  + Body
        <!-- include(body/processingplan/products_post_some_response.json) -->

## Продукт Тех. карты [/entity/processingplan/{id}/products/{positionID}]
+ Parameters
  + id: `d72b4281-b000-11e6-8af5-581e00000074` (required, string) - id Тех. карты
  + positionID: `9560e3e3-9609-11e6-8af5-581e00000008` (required, string) - id продукта Тех. карты

### Получить продукт [GET]
Запрос на получение отдельного продукта Тех. карты с указанным id.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного продукта Тех. карты.
  + Body
        <!-- include(body/processingplan/products_get_by_id.json) -->

### Изменить продукт [PUT]
Запрос на обновление отдельного продукта Тех. карты. Для обновления продукта нет каких-либо
 обязательных для указания в теле запроса полей. Только те, что вы желаете обновить.
+ Request Пример (application/json)
Пример запроса на обновление отдельного продукта в Тех. карте.
  + Body
        <!-- include(body/processingplan/products_put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого продукта Тех. карты.
  + Body
        <!-- include(body/processingplan/products_put_response.json) -->

### Удалить продукт [DELETE]
Запрос на удаление продукта Тех. карты с указанным id.

+ Response 200 (application/json)
Успешное удаление продукта Тех. карты.
